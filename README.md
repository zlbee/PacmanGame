## ZhangliWANG-20028336

## task01 | fxml files & MVC pattern

# Create three new fxml files for displaying interfaces.
startpage.fxml -> display startpage  
highscore.fxml -> display highscore  
setup.fxml -> display setup page  
pacman.fxml -> display game page  
Corresponding controller classes and main classes are also created.  

# Create three new packages in src folder:  
pacman.controller  
pacman.model  
pacman.view  

# Seperate classes and sources in sample package to the three packages with regard of their functionalities. 
Classes are only classified, no content are modified except the Pacman.java class. 
The sample package is remained for retaining initial files.  

1. pacman.controller  
Controller.java  
HighscoreController.java  
Pacman.java (renamed from Main.java from sample package)  
Setup.java  
StatPage.java  
StartpageController.java  

2. pacman.model  
BarObstacle.java  
Cookie.java  
GameManager.java  
Ghost.java  
Maze.java  
ThePacman.java (renamed from Pacman.java from sample package)    
			   (still represents the pacman in the game)  
Score.java  

3. pacman.view  
ghost1.png  
ghost2.png  
ghost3.png  
ghost4.png  
ghost5.png  
pacman.png  
highscore.fxml  
pacman.fxml  
setup.fxml  
startpage.fxml  

## task02 | setup page & import images
Add color pickers to setup page.  
The color pickers are currently not working.
Import images for pacman and ghosts.   

## task03 | background color setup
Color pickers now work in this version.
In the setup page, color pickers can respectively modify background color and wall color before the game starts.  

  background color picker changes background color by modifying color of the graphic context of canvas in the game page.
  wall color picker changes wall color by modifying color of bar obstacle.

## task04 | create portals
In this update, I create two portals for pacman to teleport between them.
The Maze class is modified. Left frame and right frame are cut through to deploy the portals.
There are two classes being added to the model package.
1. Portal  
2. DoublePortals  
A portal is a rectangle that has only 1 width.  
The DoublePortals class has two portals(leftPortal, rightPortal).
method in DoublePortals:  
1. generatePortals: initialize values of leftPortal and rightPortal.
2. checkPortalCoalition: teleport the pacman between the two portals if he touches portals.  

GameManager class initialized DoublePortals and check whether pacman touches portals while it is moving.  

During this task, I found check coaliton methods in GameManager class should be moved to other classes.  

## task05 | refactor01
In this update, I refactored part of the GameManager class.
I extract Javafx portions of drawBoard(renamed as initGame), endGame, startGame methods from the GameManager class.  
These parts are put into a newly created class:  
GameController  
in controller package.  
This class is in charge of responding changes to model and updating view.  

## task06 | refactor02 & design patterns
In this update, I continued to update the GameManager class and add design patterns to the project.  
# refactor02
In the GameManager class  
movePacman, stopPacman methods  
are moved to GameController class.  
createAnimation method and relative fields are moved to ThePacman class.  
Till this task is finished, the GameManager class is in charge of loading game objects and defining game interactions. The GameManager class, Cookie class, ThePacman class, Ghost class and DoublePortals class compose the model in MVC pattern. The GameController class is in charge of manipulating game objects and game interactions and updating changes to the view. Future adjustment may remain to be done.  
# design patterns
Singleton and Observer design patterns are added to the project.  
Singleton design pattern is adopted to GameManager class, assuring it has only one instance.  
Observer design pattern is adopted in GameManager class and GameController class, where GameManager is observed and GameController is the observer. Once some events is happening in the model and the view need to be changed, the GameManager should notify GameController to make changes to the view. The events are the pacman is losing life and the game is ended.  

## task07 | refactor03 & additional functions & score board
# refactor03 & factorial pattern
In this update, refactor is continued and many functions are added to the project.  
1. factorial pattern
An interface named Actor is created to define actors in the scene.  
ThePacman class and Ghost class now implement Actor interface.  
A class named ActorFactory is created to generate actor instances, all actors should be generated by getActor method in this class.  
The pacman and ghosts instances are now generated in factorial way.  

2. refactor03
a.  
In the GameManager class  
checkCookieCoalition, checkGhostCoalition, checkPortalCoaliton methods are moved to ThePacMan class, because the pacman is the role to check object coalition. 
The same idea is adopted to Ghost class. CheckPortalsCoaliton method is now written in Ghost class as well, allowing ghost to teleport between the portals.  
b. 
In the original version, the ghosts sometimes blink out of the map.  
I rearranged the judgemental codes of changing directions in the Ghost class to correct the logic.  
I decreased the judgemental padding by 1 to elimate the hesitation at crossroads.  

# score board
Now when the game is finished, a highscore window will pop up to show the highscores sorted by score values.  
Reader, Writer and ScoreRecord classes and highscore.txt are created to achieve this function.  
Reader class is in charge of read contents from the text file.  
Writer class is in charge of write scores into the text file.  
ScoreRecord class is in charge of storing a static arraylist of Score named scores and sort the arraylist by score values.  
HighScore, HighScoreController, GameController classes and highscore.fxml are updated to achieve this function.  
When the game is ended, GameController will add score of this game to the arraylist, call ScoreRecord to sort the arraylist and show the highscore window.  
The highscore window is initialized with Reader to read the arraylist to the textarea in the window.  

# additional functions
1. super cookie
Now there is a super cookie at the left bottom side of the map, the pacman can eat it to boost its speed.  
2. infinite mode
Now in the start page, player can choose to play normal mode or infinite mode.  
In the infinite mode, after pacman eating all cookies in the map, a level entry will appear at the right bottom side of the map.  
The pacman should reach it to enter next level.  
In the next level, game is reset except the score board including score and lifes, the player can continue to play the game infinitely with the remaining lifes. Ghosts can get slightly faster in the next level, so it is necessary to approach and eat the super cookie in higher levels.  
3. ghost barrier  
I switched the spawn points of ghosts and the pacman, now the area in the center becomes the safe house for the pacman thanks to the ghost barrier.    
A new class named GhostBarObstacle is created extending the BarObstacle class to block the ghost but not the pacman.  
In the Maze class, a ghost obstacle is put at the entry of the block in the center, rejecting ghosts outside the house.  

# final version
Javaoc, video, report are added as the requirements.  
Additional function: now image of the pacman will be changed according to its movement.  
A main package is created, to run this project, run StartPage.java file in this package with IDEA.  
Visual bug of scoreboard when the pacman enters the next level is fixed.  